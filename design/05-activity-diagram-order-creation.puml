@startuml
title "活动图 - 订单创建流程"

|用户|
start
:在订单确认页面;
:确认商品信息;
:选择/新增收货地址;
:选择优惠券;
:查看最终金额;
:点击"提交订单";

|系统|
:接收订单提交请求;
:验证收货地址;
:验证商品库存;
:验证商品价格;
:验证优惠券有效性;

if (所有验证通过?) then (是)
  :计算最终总价;
  :创建订单记录到数据库 (状态: PENDING_PAYMENT);
  :锁定商品库存;
  :清空购物车中已结算的商品;
  :生成支付链接或二维码;
  |用户|
  :跳转到支付页面;
  note right
   流程转到
   《支付处理流程》
  end note
  stop
else (否)
  |用户|
  :收到错误提示;
  note right
    例如: "商品库存不足"
    或 "优惠券无效"
  end note
  :返回订单确认页或购物车;
  stop
endif

@enduml 